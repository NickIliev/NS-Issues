<Page loaded="pageLoaded" 
    xmlns:lv="nativescript-telerik-ui/listview"
    xmlns:nativescript-fresco="nativescript-fresco"
    xmlns="http://www.nativescript.org/tns.xsd">
    <ActionBar>
        <GridLayout columns="auto,*,auto" >
            <Image col="0" src="~/images/back.png" tap="buttonBackTap"/>
            <Image col="2" src="~/images/logo-xs.png"/>
        </GridLayout>
    </ActionBar>
    <GridLayout>
        <StackLayout>
            <GridLayout columns="*,*,*,*" rows="auto,auto">
                <StackLayout row="0" col="0" >
                    <GridLayout columns="auto,auto" cssClass="filtro" horizontalAlignment="center" > 
                        <Label col="0"  text="Planes"  tap="showAcordeon" />
                        <Image col="1"  src="~/images/arrow-bottom.png"  />
                    </GridLayout>
                    <GridLayout cssClass="filtrolabel" columns="*,auto" tipo="planes" tap="deleteFiltro" visibility="{{ planesFiltro!==''?'visible':'collapsed' }}" >
                        <Label col="0" text="{{ planesfiltro }}" />
                        <Image col="1" src="~/images/x.png"/>
                    </GridLayout>
                </StackLayout>
                
                <StackLayout row="0" col="1" >
                    <GridLayout columns="auto,auto" cssClass="filtro"   horizontalAlignment="center">
                        <Label col="0"  text="Marcas"  tap="showAcordeon" />
                        <Image col="1" src="~/images/arrow-bottom.png" />
                    </GridLayout>
                    <GridLayout cssClass="filtrolabel" columns="*,auto" tipo="marcas" tap="deleteFiltro" visibility="{{ marcasFiltro!==''?'visible':'collapsed' }}" >
                        <Label col="0" text="{{ marcasfiltro }}" />
                        <Image col="1" src="~/images/x.png"/>
                    </GridLayout>
                </StackLayout>
                
                <StackLayout row="0" col="2">
                    <GridLayout columns="auto,auto" cssClass="filtro"   horizontalAlignment="center">
                        <Label col="0"  text="Precio"  tap="showAcordeon" />
                        <Image col="1" src="~/images/arrow-bottom.png" />
                    </GridLayout>
                    <GridLayout cssClass="filtrolabel" columns="*,auto" tipo="precios" tap="deleteFiltro" visibility="{{ preciosFiltro!==''?'visible':'collapsed' }}" >
                        <Label col="0" text="{{ preciosfiltro }}" />
                        <Image col="1" src="~/images/x.png" />
                    </GridLayout>
                </StackLayout>
                
                <StackLayout row="0" col="3">
                    <GridLayout columns="auto,auto" cssClass="filtro"   horizontalAlignment="center">
                        <Label col="0"  text="Chip"  tap="showAcordeon" />
                        <Image col="1" src="~/images/arrow-bottom.png" />
                    </GridLayout>
                    <GridLayout cssClass="filtrolabel" columns="*,auto" tipo="chip" tap="deleteFiltro" visibility="{{ chipsFiltro!==''?'visible':'collapsed' }}" >
                        <Label col="0" text="{{ chipfiltro }}"/>
                        <Image col="1" src="~/images/x.png"/>
                    </GridLayout>
                </StackLayout>

            </GridLayout>

            <lv:RadListView id="repeater" items="{{ listItems }}"  scrollDirection="Vertical" loadOnDemandMode="Auto" loadMoreDataRequested="loadOnDemand" >
                <lv:RadListView.listViewLayout>
                    <lv:ListViewGridLayout scrollDirection="Vertical" spanCount="3"/>
                </lv:RadListView.listViewLayout>
                <lv:RadListView.itemTemplate>
                    <GridLayout rows="*,*,auto" tap="onListViewItemTap" index="{{ id }}" cssClass="contenedor" visibility="{{ visible?'visible':'collapsed'}}" >
                        <Image row="0" src="~/images/ribbon-new.png"  stretch="none"  horizontalAlignment="left" cssClass="nuevo" visibility="{{ nuevo?'visible':'collapsed'}}" />
                        <nativescript-fresco:FrescoDrawee row="1" imageUri="{{ imagen }}"/>
                        <Image row="1" src="~/images/ribbon-promo.png"  stretch="none"  horizontalAlignment="left" cssClass="online" visibility="{{ online?'visible':'collapsed'}}"/>
                        <Image row="1" src="~/images/ribbon-4g.png"  stretch="none"  horizontalAlignment="left" cssClass="lte4g" visibility="{{ 4glte?'visible':'collapsed'}}"/>
                        <StackLayout row="2">
                            <Label text="{{ marca }}" cssClass="marcaProducto"/>                          
                            <Label text="{{ modelo }}" cssClass="modeloProducto"/>
                            <Label text="{{ 'S/ ' + precio }}" cssClass="precio" visibility="{{ precio>0?'collapsed':'visible'}}" />
                            <GridLayout columns="*,*" visibility="{{ precio>0?'visible':'collapsed'}}">
                                <Label col="0" id="precio" text="{{ precio }}" cssClass="precio" horizontalAlignment="right" />
                                <Label col="1" text="{{ 'S/ ' + pagina }}" cssClass="precionormal" horizontalAlignment="left"/>
                            </GridLayout>
                            <Label text="{{ 'En plan Postpago ' + plan + ' con acuerdo de equipos a 18 meses' }}" cssClass="etiqueta" textWrap="true"/>
                        </StackLayout>
                    </GridLayout>

                    <!--<StackLayout>
                        <nativescript-fresco:FrescoDrawee imageUri="{{ imagen }}" height="160" width="100"/>                     
                    </StackLayout>-->

                    
                </lv:RadListView.itemTemplate>
            </lv:RadListView>
        </StackLayout>
        
        <GridLayout opacity="0.7" style.backgroundColor="#000000" tap="hideModal" visibility="{{ modal?'visible':'collapsed'}}">
        </GridLayout>


            <StackLayout id="modal" verticalAlignment="middle">

                    <ScrollView cssClass="acordeon" visibility="{{ chip?'visible':'collapsed'}}">
                        <StackLayout width="100%">
                            <Label text="Seleccione el chip" class="etiquetafiltro"/> 
                            <StackLayout cssClass="form-item-border"></StackLayout>
                            <Label text="Prepago" tipo="chip" cssClass="filtrar" tap="selectFiltro" />
                            <StackLayout cssClass="form-item-border"></StackLayout>
                            <Label text="Postpago" tipo="chip" cssClass="filtrar" tap="selectFiltro" />
                            <StackLayout cssClass="form-item-border"></StackLayout>
                        </StackLayout>
                    </ScrollView>

                    <ScrollView cssClass="acordeon" visibility="{{ precios?'visible':'collapsed'}}">
                        <StackLayout width="100%">
                            <Label text="Ordenar por precio" class="etiquetafiltro"/> 
                            <StackLayout cssClass="form-item-border"></StackLayout>
                            <Label text="De mayor a menor" tipo="0" cssClass="filtrar" tap="selectFiltro" />
                            <StackLayout cssClass="form-item-border"></StackLayout>
                            <Label text="De menor a mayor" tipo="1" cssClass="filtrar" tap="selectFiltro" />
                            <StackLayout cssClass="form-item-border"></StackLayout>
                        </StackLayout>
                    </ScrollView>

                    <ScrollView cssClass="acordeon" visibility="{{ marcas?'visible':'collapsed'}}">
                        <StackLayout width="100%" >
                            <Label text="Filtrar por marca" class="etiquetafiltro"/>
                            <StackLayout cssClass="form-item-border"></StackLayout>
                            <Label text="Ver todos" tipo="marcas" cssClass="filtrar" tap="selectFiltro" />
                            <Repeater items="{{ vmMarcas }}">
                                <Repeater.itemsLayout>
                                    <StackLayout/>
                                </Repeater.itemsLayout>
                                <Repeater.itemTemplate>
                                    <StackLayout>
                                        <StackLayout cssClass="form-item-border"></StackLayout>
                                        <Label text="{{nombre}}" tipo="marcas" cssClass="filtrar" tap="selectFiltro" />
                                    </StackLayout>
                                </Repeater.itemTemplate>
                            </Repeater>
                            <StackLayout cssClass="form-item-border"></StackLayout>
                        </StackLayout>
                    </ScrollView>
            
                    <ScrollView cssClass="acordeon" visibility="{{ loquieroen?'visible':'collapsed'}}">
                        <StackLayout width="100%">
                            <Label text="Lo quiero en:" class="etiquetafiltro"/> 
                            <StackLayout cssClass="form-item-border"></StackLayout>
                            <Label text="Línea nueva" tipo="n" cssClass="filtrar" tap="selectFiltro" />
                            <StackLayout cssClass="form-item-border"></StackLayout>
                            <Label text="Portabilidad" tipo="p" cssClass="filtrar" tap="selectFiltro" />
                            <StackLayout cssClass="form-item-border"></StackLayout>
                            <Label text="Renovación" tipo="r" cssClass="filtrar" tap="selectFiltro" />
                            <StackLayout cssClass="form-item-border"></StackLayout>
                        </StackLayout>
                    </ScrollView>

                    <ScrollView cssClass="acordeon" visibility="{{ planes?'visible':'collapsed'}}">
                        <StackLayout width="100%" >
                            <Label text="Seleccione un plan" class="etiquetafiltro"/>
                            <StackLayout cssClass="form-item-border"></StackLayout>
                            <Label text="Ver todos" tipo="planes" cssClass="filtrar" tap="selectFiltro" />
                            <Repeater items="{{ vmPlanes }}">
                                <Repeater.itemsLayout>
                                    <StackLayout/>
                                </Repeater.itemsLayout>
                                <Repeater.itemTemplate>
                                    <StackLayout>
                                        <StackLayout cssClass="form-item-border"></StackLayout>
                                        <Label text="{{nombre}}" planfiltro="{{id}}" tipo="planes" cssClass="filtrar" tap="selectFiltro" />
                                    </StackLayout>
                                </Repeater.itemTemplate>
                            </Repeater>
                            <StackLayout cssClass="form-item-border"></StackLayout>
                        </StackLayout>
                    </ScrollView>

            </StackLayout>

    </GridLayout>
</Page>
<!--<Page xmlns="http://schemas.nativescript.org/tns.xsd" 
    xmlns:widgets="utils/widgets"
    xmlns:lv="nativescript-telerik-ui/listview"
    loaded="pageLoaded" id="productosScreen">
    <Page.actionBar>
        <widgets:action-bar />
    </Page.actionBar>
    <StackLayout>
        <ScrollView>
            <GridLayout rows="auto, *">
                <Repeater id="repeater" items="{{ listItems }}" >
                    <Repeater.itemsLayout>
                        <WrapLayout />
                    </Repeater.itemsLayout>
                    <Repeater.itemTemplate>
                        <GridLayout rows="*,*,auto" tap="onListViewItemTap" index="{{ id }}" cssClass="contenedor" >
                            <Image row="0" src="~/images/ribbon-new.png"  stretch ="none"  horizontalAlignment="left" cssClass="nuevo" visibility="{{ nuevo?'visible':'collapsed'}}" />
                            <Image row="1" src="{{ imagen }}" stretch="aspectFill"   loadMode="async" cssClass="imagen"/>
                            <Image row="1" src="~/images/ribbon-promo.png"  stretch ="none"  horizontalAlignment="left" cssClass="solooline" visibility="{{ online?'visible':'collapsed'}}"/>
                            <Image row="1" src="~/images/ribbon-4g.png"  stretch ="none"  horizontalAlignment="left" cssClass="lte4g" visibility="{{ 4glte?'visible':'collapsed'}}"/>
                            <StackLayout row="2">
                                <Label col="1" text="{{ marca }}" cssClass="marcaProducto"/>                          
                                <Label text="{{ nombre }}" cssClass="modeloProducto"/>
                                <Label text="{{ 'S/ ' + precio }}" cssClass="precio" visibility="{{ precio>0?'collapsed':'visible'}}" />
                                <GridLayout columns="*,*" visibility="{{ precio>0?'visible':'collapsed'}}">
                                    <Label col="0" id="precio" text="{{ 'S/ ' + (tipo=='lineanueva'?details.lineanueva:(tipo=='renovacion'?details.renovacion:details.portabilidad))  }}" cssClass="precio" horizontalAlignment="right" visibility="{{planes?'collapsed':'visible'}}"/>
                                    <Label col="0" text="{{ 'S/ ' + precioplan }}" cssClass="precio" horizontalAlignment="right" visibility="{{planes?'visible':'collapsed'}}" colSpan="2" horizontalAlignment="center"/>
                                    <Label col="1" text="{{ 'S/ ' + details.precionormal }}" cssClass="precionormal" horizontalAlignment="left" visibility="{{planes?'collapsed':'visible'}}"/>
                                </GridLayout>
                                <Label text="{{ plan }}" cssClass="etiqueta" textWrap="true"/>
                            </StackLayout>
                        </GridLayout>
                    </Repeater.itemTemplate>
                </Repeater>
                <ActivityIndicator row="1" busy="{{ isLoading }}" /> 
            </GridLayout>
        </ScrollView>
    </StackLayout>
</Page>-->