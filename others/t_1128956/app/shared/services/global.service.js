"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var http_1 = require("@angular/http");
require("rxjs/add/operator/do");
require("rxjs/add/operator/map");
var AesUtil_1 = require("../utils/AesUtil");
var CryptoJS = require('crypto-js');
var GlobalService = (function () {
    function GlobalService(http //, httpInterceptor: HttpInterceptorService
    ) {
        // httpInterceptor.request().addInterceptor((data, method) => {
        //     console.log("encrypt");
        //     console.log(method, data);
        //     return data;
        // });
        this.http = http; //, httpInterceptor: HttpInterceptorService
        // apiURL: string = "http://10.0.2.2:8080/bcbsma/mma/v1/";
        // https://bcbsma-nonprod-dev.apigee.net/verify_stub
        //   apiURL: string = "https://bcbsma-test.apigee.net/";
        this.apiURL = "https://bcbsma-nonprod-dev.apigee.net/";
        // httpInterceptor.response().addInterceptor((res, method) => {
        //     console.log("decrypt");
        //     return res.do(r => console.log(method, r));
        // }); 
    }
    GlobalService.prototype.globalGet = function (url) {
        return this.http.get(this.apiURL + url, this.jwt()).map(function (response) { return response.json(); });
    };
    GlobalService.prototype.bcbsmaGet = function (url, headers) {
        return this.http.get(this.apiURL + url, headers).map(function (response) { return response.json(); });
    };
    GlobalService.prototype.globalPost = function (url, params) {
        return this.http.post(this.apiURL + url, params, this.jwt())
            .map(function (response) { return response.json(); });
    };
    GlobalService.prototype.globalLoginPost = function (url, body) {
        this.encrypt();
        return this.http.post(this.apiURL + url, body, this.loginjwt())
            .map(function (response) { return response.json(); });
    };
    GlobalService.prototype.encrypt = function () {
        var iv = "418f8eddd436d1d96b19b8a85563e7bb"; // "b5ccea620067ce288f603713f39eb00f"; //"6a6c26a8b978f4c006739aae336a7597"; //"F27D5C9927726BCEFE7510B1BDD3D137";
        var salt = "06e02857911c4aa8e2d0c02c6a0ca082aa7e7c13a86545d9b0b2ad55fd61511e"; // "98bb84733547bc5447d2da3aebdb217330476107a175e63ce0bd2407b5d8f57c";// "126583de0858dff5b59ffd3b73f04b45c60d4c95401e6e76accb812139823f42"; //"3FF2EC019C627B945225DEBAD71A01B6985FE84C95A70EB132882F88C0A59A55";
        var keySize = 128;
        var iterationCount = 10000;
        var passphrase = "4f0e2c70dedc3b98284805c141e8d46d708906553f56f7a04b43590d38f2ef8a"; // "81b7a5b797f44c04ad43b63740ffc0d58911b70178cbde9c24e10b8bb06a9e0a"; //"a02e382961c1e0d9010e391af801a6b2018b61562af66ad918db37f60acbbf63"; // "26DEC4ECAF3ABBBCD3C6156704617CCF";
        // var plaintext = "{\"regtypein\":\"EMAIL\",\"useridin\":\"test@test.com\",\"passwordin\":\"password01\",\"receiveinfo\":\"yes\",\"tandcagreed\":\"true‚Äù}";
        //  var plaintext = "{\"regtypein\":\"EMAIL\",\"useridin\":\"test22520@test.com\",\"passwordin\":\"password01\",\"receiveinfo\":\"yes\",\"tandcagreed\":\"true\"}";
        //   var plaintext = "{\"useridin\":\"test22520@test.com\",\"key2id\":\"5023bd2461e9441bb28e7b43793b62e7\"}";
        //  var plaintext = "ysZTaNV0wAYdVE6WcH4zpURITw45K6d86LbFdot9G2rG5b8zaDp8ik8UDSME1zGykltAnv3ZXA1bLc0z+jGh4HmusBmCs30VwuharUXdPD3i6xt6SuG6ox17wKgNPxPlSyMDm+Z6t+9grqPAjFqwEwjQEReC9FcyBYdVYtffkP0Vv9eDtEboqKw84EPaC8jQPbWxRQpmnrGqGCPnZQCpnMnhz2CtqxsrLPelwOzzP6VIgKi/obFzuNb+oLKFmq9DxRp+rgLjTgHXH4Gh1BnC6S97smhO/92Jy4xmdRDuYHyH7BIpXibc6Suq0o1Lu/m9ezwdLOq9mmQuPu3sGYYEIxN1oDFrZ1p/iUS03nF/n/oOjPr8gO4iJe84HJKtBoxu0gVZ20+A9D8O2IXg4ugjDIBgKjqZHIz4KbmIdMnfbjaPSm8bQneXLQm1XRu6VvyDePl27KYmMtbzQwZK3lCA1bmOuCa/E8JUYwDflTEr3VUavEXoD47WHxaFC1s3TXHu";
        // console.log('Plain Text : ' + plaintext);
        var toDecryptText = 'kOWAuf0hKHFW1rlwWc91auvUI2C9+gelPPuSzZlnU1+aosJnVTMC87vUphtvWlRgW4BCz1U3phP5iRELU6Iu0DnuWlClLftGhZ+0bd7KmfrfpGZTwl1hfjcvCgsNOOR8D1y8S19vbxgA6pewE0Ke7/k9Bt2TFjQ2fzfW9xJAoNammSdGmHGrgVHPtBSgmnGZ6KfqWHwGvhJkvzcEn0PcI3paZz94lbd74U04W/aB+ahYkQgvcXQkCKLIrWJjus3JMzzoSM+FuQ9XNbedLKrW4fvpLT4feav3BnRy7bJcswOZwysnnk4DnB4xSa54Y4NkgrnVlteCN2FakAh/Eouj3yx3HvSn/s0pbeKWXIlRsWHNqYE1cUfxK00vaznbMTyp4BK7Rx8DDmPc+nCcG36XwwigLs3Er2yNsOSV6nQ26cpT87haWbpDdUF9f3ECBKAZsA02jdt+Oj8sBJdbb/yneFWNokLbj7DSH4TWNg+fxdvUwUXip3fyLbJVcfmZE7uF6ku11kj8uP+6kXuIVLgkN1e0hVdS0pP9ODyRph2q0X4=';
        var aesUtil = new AesUtil_1.AesUtil(keySize, iterationCount);
        // var ciphertext = aesUtil.encrypt(salt, iv, passphrase, plaintext);
        // console.log('Encrypted Data : ' + ciphertext);
        var decryptedText = aesUtil.decrypt(salt, iv, passphrase, toDecryptText);
        console.log('Decrypted Data : ' + decryptedText);
    };
    // private helper methods
    GlobalService.prototype.jwt = function () {
        // create authorization header with jwt token
        // let currentUser = JSON.parse(localStorage.getItem("currentUser"));
        // if (currentUser && currentUser.token) {
        var headers = new http_1.Headers();
        headers.append("Content-Type", "application/json");
        headers.append("Authorization", "Bearer Fq5xC3LhCUvkcr7qVIJVbmo3LvcO");
        //  headers.append("client_id", "2");
        // headers.append("access_token", "2");
        return new http_1.RequestOptions({ headers: headers });
        // }
    };
    GlobalService.prototype.loginjwt = function () {
        var headers = new http_1.Headers();
        headers.append("Content-Type", "application/json");
        return new http_1.RequestOptions({ headers: headers });
        // return { 'Content-Type': 'application/json' };
    };
    return GlobalService;
}());
GlobalService = __decorate([
    core_1.Injectable(),
    __metadata("design:paramtypes", [http_1.Http //, httpInterceptor: HttpInterceptorService
    ])
], GlobalService);
exports.GlobalService = GlobalService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2xvYmFsLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJnbG9iYWwuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHNDQUEyQztBQUMzQyxzQ0FBd0U7QUFJeEUsZ0NBQThCO0FBQzlCLGlDQUErQjtBQU0vQiw0Q0FBMkM7QUFDM0MsSUFBSSxRQUFRLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFBO0FBR25DLElBQWEsYUFBYTtJQU90Qix1QkFBb0IsSUFBVSxDQUFDLDJDQUEyQzs7UUFJdEUsK0RBQStEO1FBQy9ELDhCQUE4QjtRQUM5QixpQ0FBaUM7UUFDakMsbUJBQW1CO1FBQ25CLE1BQU07UUFSVSxTQUFJLEdBQUosSUFBSSxDQUFNLENBQUMsMkNBQTJDO1FBTjFFLDBEQUEwRDtRQUMxRCxvREFBb0Q7UUFDcEQsd0RBQXdEO1FBQ3hELFdBQU0sR0FBVyx3Q0FBd0MsQ0FBQztRQWF0RCwrREFBK0Q7UUFDL0QsOEJBQThCO1FBQzlCLGtEQUFrRDtRQUNsRCxPQUFPO0lBRVgsQ0FBQztJQUVELGlDQUFTLEdBQVQsVUFBVSxHQUFXO1FBQ2pCLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQyxRQUFrQixJQUFLLE9BQUEsUUFBUSxDQUFDLElBQUksRUFBRSxFQUFmLENBQWUsQ0FBQyxDQUFDO0lBQ3JHLENBQUM7SUFDRCxpQ0FBUyxHQUFULFVBQVUsR0FBVyxFQUFFLE9BQVk7UUFDL0IsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFDLFFBQWtCLElBQUssT0FBQSxRQUFRLENBQUMsSUFBSSxFQUFFLEVBQWYsQ0FBZSxDQUFDLENBQUM7SUFFbEcsQ0FBQztJQUVELGtDQUFVLEdBQVYsVUFBVyxHQUFXLEVBQUUsTUFBVztRQUUvQixNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxHQUFHLEVBQUUsTUFBTSxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQzthQUN4RCxHQUFHLENBQUMsVUFBQyxRQUFrQixJQUFLLE9BQUEsUUFBUSxDQUFDLElBQUksRUFBRSxFQUFmLENBQWUsQ0FBQyxDQUFDO0lBQ3RELENBQUM7SUFFRCx1Q0FBZSxHQUFmLFVBQWdCLEdBQVcsRUFBRSxJQUFTO1FBQ2xDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNmLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBRSxJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO2FBQzVELEdBQUcsQ0FBQyxVQUFDLFFBQWtCLElBQUssT0FBQSxRQUFRLENBQUMsSUFBSSxFQUFFLEVBQWYsQ0FBZSxDQUFDLENBQUM7SUFDckQsQ0FBQztJQUVELCtCQUFPLEdBQVA7UUFDSSxJQUFJLEVBQUUsR0FBRSxrQ0FBa0MsQ0FBQyxDQUFDLGtIQUFrSDtRQUM5SixJQUFJLElBQUksR0FBRSxrRUFBa0UsQ0FBQyxDQUFDLGtOQUFrTjtRQUNoUyxJQUFJLE9BQU8sR0FBRyxHQUFHLENBQUM7UUFDbEIsSUFBSSxjQUFjLEdBQUcsS0FBSyxDQUFDO1FBQzNCLElBQUksVUFBVSxHQUFHLGtFQUFrRSxDQUFDLENBQUMsbUxBQW1MO1FBQzNRLDRKQUE0SjtRQUM3SixtS0FBbUs7UUFDbEssNkdBQTZHO1FBQzlHLHVoQkFBdWhCO1FBQ25oQiw0Q0FBNEM7UUFDNUMsSUFBSSxhQUFhLEdBQUcsOGlCQUE4aUIsQ0FBQztRQUNua0IsSUFBSSxPQUFPLEdBQUcsSUFBSSxpQkFBTyxDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUMsQ0FBQztRQUNuRCxxRUFBcUU7UUFDckUsaURBQWlEO1FBQ2xELElBQUksYUFBYSxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFDLEVBQUUsRUFBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFDdkUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsR0FBRyxhQUFhLENBQUMsQ0FBQztJQUNwRCxDQUFDO0lBR0QseUJBQXlCO0lBQ2xCLDJCQUFHLEdBQVY7UUFDSSw2Q0FBNkM7UUFDN0MscUVBQXFFO1FBQ3JFLDBDQUEwQztRQUMxQyxJQUFJLE9BQU8sR0FBRyxJQUFJLGNBQU8sRUFBRSxDQUFDO1FBQzVCLE9BQU8sQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLGtCQUFrQixDQUFDLENBQUM7UUFDbkQsT0FBTyxDQUFDLE1BQU0sQ0FBQyxlQUFlLEVBQUUscUNBQXFDLENBQUMsQ0FBQztRQUN2RSxxQ0FBcUM7UUFDckMsdUNBQXVDO1FBR3ZDLE1BQU0sQ0FBQyxJQUFJLHFCQUFjLENBQUMsRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztRQUNoRCxJQUFJO0lBQ1IsQ0FBQztJQUNNLGdDQUFRLEdBQWY7UUFDSSxJQUFJLE9BQU8sR0FBRyxJQUFJLGNBQU8sRUFBRSxDQUFDO1FBQzVCLE9BQU8sQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLGtCQUFrQixDQUFDLENBQUM7UUFDbkQsTUFBTSxDQUFDLElBQUkscUJBQWMsQ0FBQyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQ2hELGlEQUFpRDtJQUNyRCxDQUFDO0lBdUJMLG9CQUFDO0FBQUQsQ0FBQyxBQTNHRCxJQTJHQztBQTNHWSxhQUFhO0lBRHpCLGlCQUFVLEVBQUU7cUNBUWlCLFdBQUksQ0FBQywyQ0FBMkM7O0dBUGpFLGFBQWEsQ0EyR3pCO0FBM0dZLHNDQUFhIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IEh0dHAsIEhlYWRlcnMsIFJlcXVlc3RPcHRpb25zLCBSZXNwb25zZSB9IGZyb20gXCJAYW5ndWxhci9odHRwXCI7XHJcbi8vaW1wb3J0IHsgSHR0cEludGVyY2VwdG9yU2VydmljZSB9IGZyb20gXCJuZy1odHRwLWludGVyY2VwdG9yXCI7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwicnhqcy9PYnNlcnZhYmxlXCI7XHJcblxyXG5pbXBvcnQgXCJyeGpzL2FkZC9vcGVyYXRvci9kb1wiO1xyXG5pbXBvcnQgXCJyeGpzL2FkZC9vcGVyYXRvci9tYXBcIjtcclxuXHJcbi8vaW1wb3J0ICogYXMgSHR0cHMgZnJvbSAnbmF0aXZlc2NyaXB0LWh0dHBzJztcclxuLy9pbXBvcnQgeyBIdHRwc1JlcXVlc3RPcHRpb25zIH0gZnJvbSAnbmF0aXZlc2NyaXB0LWh0dHBzJztcclxuXHJcbmltcG9ydCB7IEFzeW5jU3ViamVjdCB9IGZyb20gJ3J4anMvQXN5bmNTdWJqZWN0JztcclxuaW1wb3J0IHsgQWVzVXRpbCB9IGZyb20gJy4uL3V0aWxzL0Flc1V0aWwnO1xyXG52YXIgQ3J5cHRvSlMgPSByZXF1aXJlKCdjcnlwdG8tanMnKVxyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgR2xvYmFsU2VydmljZSB7XHJcbiAgICAvLyBhcGlVUkw6IHN0cmluZyA9IFwiaHR0cDovLzEwLjAuMi4yOjgwODAvYmNic21hL21tYS92MS9cIjtcclxuICAgIC8vIGh0dHBzOi8vYmNic21hLW5vbnByb2QtZGV2LmFwaWdlZS5uZXQvdmVyaWZ5X3N0dWJcclxuICAgIC8vICAgYXBpVVJMOiBzdHJpbmcgPSBcImh0dHBzOi8vYmNic21hLXRlc3QuYXBpZ2VlLm5ldC9cIjtcclxuICAgIGFwaVVSTDogc3RyaW5nID0gXCJodHRwczovL2JjYnNtYS1ub25wcm9kLWRldi5hcGlnZWUubmV0L1wiO1xyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGh0dHA6IEh0dHAgLy8sIGh0dHBJbnRlcmNlcHRvcjogSHR0cEludGVyY2VwdG9yU2VydmljZVxyXG4gICAgKSB7XHJcblxyXG5cclxuICAgICAgICAvLyBodHRwSW50ZXJjZXB0b3IucmVxdWVzdCgpLmFkZEludGVyY2VwdG9yKChkYXRhLCBtZXRob2QpID0+IHtcclxuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coXCJlbmNyeXB0XCIpO1xyXG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhtZXRob2QsIGRhdGEpO1xyXG4gICAgICAgIC8vICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICAvLyB9KTtcclxuXHJcbiAgICAgICAgLy8gaHR0cEludGVyY2VwdG9yLnJlc3BvbnNlKCkuYWRkSW50ZXJjZXB0b3IoKHJlcywgbWV0aG9kKSA9PiB7XHJcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKFwiZGVjcnlwdFwiKTtcclxuICAgICAgICAvLyAgICAgcmV0dXJuIHJlcy5kbyhyID0+IGNvbnNvbGUubG9nKG1ldGhvZCwgcikpO1xyXG4gICAgICAgIC8vIH0pOyBcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZ2xvYmFsR2V0KHVybDogc3RyaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQodGhpcy5hcGlVUkwgKyB1cmwsIHRoaXMuand0KCkpLm1hcCgocmVzcG9uc2U6IFJlc3BvbnNlKSA9PiByZXNwb25zZS5qc29uKCkpO1xyXG4gICAgfVxyXG4gICAgYmNic21hR2V0KHVybDogc3RyaW5nLCBoZWFkZXJzOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLmdldCh0aGlzLmFwaVVSTCArIHVybCwgaGVhZGVycykubWFwKChyZXNwb25zZTogUmVzcG9uc2UpID0+IHJlc3BvbnNlLmpzb24oKSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdsb2JhbFBvc3QodXJsOiBzdHJpbmcsIHBhcmFtczogYW55KSB7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCjCoHRoaXMuYXBpVVJMICsgdXJsLCBwYXJhbXMsIHRoaXMuand0KCkpXHJcbiAgICAgICAgICAgIC5tYXAoKHJlc3BvbnNlOiBSZXNwb25zZSkgPT4gcmVzcG9uc2UuanNvbigpKTtcclxuICAgIH1cclxuICAgICAgIFxyXG4gICAgZ2xvYmFsTG9naW5Qb3N0KHVybDogc3RyaW5nLCBib2R5OiBhbnkpIHtcclxuICAgICAgICB0aGlzLmVuY3J5cHQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnBvc3QowqB0aGlzLmFwaVVSTCArIHVybCwgYm9keSwgdGhpcy5sb2dpbmp3dCgpKVxyXG4gICAgICAgICAgIC5tYXAoKHJlc3BvbnNlOiBSZXNwb25zZSkgPT4gcmVzcG9uc2UuanNvbigpKTtcclxuICAgIH1cclxuXHJcbiAgICBlbmNyeXB0KCl7XHJcbiAgICAgICAgdmFyIGl2ID1cIjQxOGY4ZWRkZDQzNmQxZDk2YjE5YjhhODU1NjNlN2JiXCI7IC8vIFwiYjVjY2VhNjIwMDY3Y2UyODhmNjAzNzEzZjM5ZWIwMGZcIjsgLy9cIjZhNmMyNmE4Yjk3OGY0YzAwNjczOWFhZTMzNmE3NTk3XCI7IC8vXCJGMjdENUM5OTI3NzI2QkNFRkU3NTEwQjFCREQzRDEzN1wiO1xyXG4gICAgICAgIHZhciBzYWx0ID1cIjA2ZTAyODU3OTExYzRhYThlMmQwYzAyYzZhMGNhMDgyYWE3ZTdjMTNhODY1NDVkOWIwYjJhZDU1ZmQ2MTUxMWVcIjsgLy8gXCI5OGJiODQ3MzM1NDdiYzU0NDdkMmRhM2FlYmRiMjE3MzMwNDc2MTA3YTE3NWU2M2NlMGJkMjQwN2I1ZDhmNTdjXCI7Ly8gXCIxMjY1ODNkZTA4NThkZmY1YjU5ZmZkM2I3M2YwNGI0NWM2MGQ0Yzk1NDAxZTZlNzZhY2NiODEyMTM5ODIzZjQyXCI7IC8vXCIzRkYyRUMwMTlDNjI3Qjk0NTIyNURFQkFENzFBMDFCNjk4NUZFODRDOTVBNzBFQjEzMjg4MkY4OEMwQTU5QTU1XCI7XHJcbiAgICAgICAgdmFyIGtleVNpemUgPSAxMjg7XHJcbiAgICAgICAgdmFyIGl0ZXJhdGlvbkNvdW50ID0gMTAwMDA7XHJcbiAgICAgICAgdmFyIHBhc3NwaHJhc2UgPSBcIjRmMGUyYzcwZGVkYzNiOTgyODQ4MDVjMTQxZThkNDZkNzA4OTA2NTUzZjU2ZjdhMDRiNDM1OTBkMzhmMmVmOGFcIjsgLy8gXCI4MWI3YTViNzk3ZjQ0YzA0YWQ0M2I2Mzc0MGZmYzBkNTg5MTFiNzAxNzhjYmRlOWMyNGUxMGI4YmIwNmE5ZTBhXCI7IC8vXCJhMDJlMzgyOTYxYzFlMGQ5MDEwZTM5MWFmODAxYTZiMjAxOGI2MTU2MmFmNjZhZDkxOGRiMzdmNjBhY2JiZjYzXCI7IC8vIFwiMjZERUM0RUNBRjNBQkJCQ0QzQzYxNTY3MDQ2MTdDQ0ZcIjtcclxuICAgICAvLyB2YXIgcGxhaW50ZXh0ID0gXCJ7XFxcInJlZ3R5cGVpblxcXCI6XFxcIkVNQUlMXFxcIixcXFwidXNlcmlkaW5cXFwiOlxcXCJ0ZXN0QHRlc3QuY29tXFxcIixcXFwicGFzc3dvcmRpblxcXCI6XFxcInBhc3N3b3JkMDFcXFwiLFxcXCJyZWNlaXZlaW5mb1xcXCI6XFxcInllc1xcXCIsXFxcInRhbmRjYWdyZWVkXFxcIjpcXFwidHJ1ZeKAnX1cIjtcclxuICAgIC8vICB2YXIgcGxhaW50ZXh0ID0gXCJ7XFxcInJlZ3R5cGVpblxcXCI6XFxcIkVNQUlMXFxcIixcXFwidXNlcmlkaW5cXFwiOlxcXCJ0ZXN0MjI1MjBAdGVzdC5jb21cXFwiLFxcXCJwYXNzd29yZGluXFxcIjpcXFwicGFzc3dvcmQwMVxcXCIsXFxcInJlY2VpdmVpbmZvXFxcIjpcXFwieWVzXFxcIixcXFwidGFuZGNhZ3JlZWRcXFwiOlxcXCJ0cnVlXFxcIn1cIjtcclxuICAgICAvLyAgIHZhciBwbGFpbnRleHQgPSBcIntcXFwidXNlcmlkaW5cXFwiOlxcXCJ0ZXN0MjI1MjBAdGVzdC5jb21cXFwiLFxcXCJrZXkyaWRcXFwiOlxcXCI1MDIzYmQyNDYxZTk0NDFiYjI4ZTdiNDM3OTNiNjJlN1xcXCJ9XCI7XHJcbiAgICAvLyAgdmFyIHBsYWludGV4dCA9IFwieXNaVGFOVjB3QVlkVkU2V2NINHpwVVJJVHc0NUs2ZDg2TGJGZG90OUcyckc1Yjh6YURwOGlrOFVEU01FMXpHeWtsdEFudjNaWEExYkxjMHorakdoNEhtdXNCbUNzMzBWd3VoYXJVWGRQRDNpNnh0NlN1RzZveDE3d0tnTlB4UGxTeU1EbStaNnQrOWdycVBBakZxd0V3alFFUmVDOUZjeUJZZFZZdGZma1AwVnY5ZUR0RWJvcUt3ODRFUGFDOGpRUGJXeFJRcG1uckdxR0NQblpRQ3BuTW5oejJDdHF4c3JMUGVsd096elA2VklnS2kvb2JGenVOYitvTEtGbXE5RHhScCtyZ0xqVGdIWEg0R2gxQm5DNlM5N3NtaE8vOTJKeTR4bWRSRHVZSHlIN0JJcFhpYmM2U3VxMG8xTHUvbTllendkTE9xOW1tUXVQdTNzR1lZRUl4TjFvREZyWjFwL2lVUzAzbkYvbi9vT2pQcjhnTzRpSmU4NEhKS3RCb3h1MGdWWjIwK0E5RDhPMklYZzR1Z2pESUJnS2pxWkhJejRLYm1JZE1uZmJqYVBTbThiUW5lWExRbTFYUnU2VnZ5RGVQbDI3S1ltTXRielF3WkszbENBMWJtT3VDYS9FOEpVWXdEZmxURXIzVlVhdkVYb0Q0N1dIeGFGQzFzM1RYSHVcIjtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygnUGxhaW4gVGV4dCA6ICcgKyBwbGFpbnRleHQpO1xyXG4gICAgICAgIHZhciB0b0RlY3J5cHRUZXh0ID0gJ2tPV0F1ZjBoS0hGVzFybHdXYzkxYXV2VUkyQzkrZ2VsUFB1U3pabG5VMSthb3NKblZUTUM4N3ZVcGh0dldsUmdXNEJDejFVM3BoUDVpUkVMVTZJdTBEbnVXbENsTGZ0R2haKzBiZDdLbWZyZnBHWlR3bDFoZmpjdkNnc05PT1I4RDF5OFMxOXZieGdBNnBld0UwS2U3L2s5QnQyVEZqUTJmemZXOXhKQW9OYW1tU2RHbUhHcmdWSFB0QlNnbW5HWjZLZnFXSHdHdmhKa3Z6Y0VuMFBjSTNwYVp6OTRsYmQ3NFUwNFcvYUIrYWhZa1FndmNYUWtDS0xJcldKanVzM0pNenpvU00rRnVROVhOYmVkTEtyVzRmdnBMVDRmZWF2M0JuUnk3Ykpjc3dPWnd5c25uazREbkI0eFNhNTRZNE5rZ3JuVmx0ZUNOMkZha0FoL0VvdWozeXgzSHZTbi9zMHBiZUtXWElsUnNXSE5xWUUxY1VmeEswMHZhem5iTVR5cDRCSzdSeDhERG1QYytuQ2NHMzZYd3dpZ0xzM0VyMnlOc09TVjZuUTI2Y3BUODdoYVdicERkVUY5ZjNFQ0JLQVpzQTAyamR0K09qOHNCSmRiYi95bmVGV05va0xiajdEU0g0VFdOZytmeGR2VXdVWGlwM2Z5TGJKVmNmbVpFN3VGNmt1MTFrajh1UCs2a1h1SVZMZ2tOMWUwaFZkUzBwUDlPRHlScGgycTBYND0nO1xyXG4gICAgICAgIHZhciBhZXNVdGlsID0gbmV3IEFlc1V0aWwoa2V5U2l6ZSwgaXRlcmF0aW9uQ291bnQpO1xyXG4gICAgICAgIC8vIHZhciBjaXBoZXJ0ZXh0ID0gYWVzVXRpbC5lbmNyeXB0KHNhbHQsIGl2LCBwYXNzcGhyYXNlLCBwbGFpbnRleHQpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdFbmNyeXB0ZWQgRGF0YSA6ICcgKyBjaXBoZXJ0ZXh0KTtcclxuICAgICAgIHZhciBkZWNyeXB0ZWRUZXh0ID0gYWVzVXRpbC5kZWNyeXB0KHNhbHQsaXYscGFzc3BocmFzZSwgdG9EZWNyeXB0VGV4dCk7XHJcbiAgICAgICBjb25zb2xlLmxvZygnRGVjcnlwdGVkIERhdGEgOiAnICsgZGVjcnlwdGVkVGV4dCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIHByaXZhdGUgaGVscGVyIG1ldGhvZHNcclxuICAgIHB1YmxpYyBqd3QoKSB7XHJcbiAgICAgICAgLy8gY3JlYXRlIGF1dGhvcml6YXRpb24gaGVhZGVyIHdpdGggand0IHRva2VuXHJcbiAgICAgICAgLy8gbGV0IGN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRVc2VyXCIpKTtcclxuICAgICAgICAvLyBpZiAoY3VycmVudFVzZXIgJiYgY3VycmVudFVzZXIudG9rZW4pIHtcclxuICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XHJcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJDb250ZW50LVR5cGVcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xyXG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXV0aG9yaXphdGlvblwiLCBcIkJlYXJlciBGcTV4QzNMaENVdmtjcjdxVklKVmJtbzNMdmNPXCIpO1xyXG4gICAgICAgIC8vICBoZWFkZXJzLmFwcGVuZChcImNsaWVudF9pZFwiLCBcIjJcIik7XHJcbiAgICAgICAgLy8gaGVhZGVycy5hcHBlbmQoXCJhY2Nlc3NfdG9rZW5cIiwgXCIyXCIpO1xyXG5cclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZXF1ZXN0T3B0aW9ucyh7IGhlYWRlcnM6IGhlYWRlcnMgfSk7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgfVxyXG4gICAgcHVibGljIGxvZ2luand0KCkge1xyXG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcclxuICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZXF1ZXN0T3B0aW9ucyh7IGhlYWRlcnM6IGhlYWRlcnMgfSk7IFxyXG4gICAgICAgIC8vIHJldHVybiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAgcHVibGljIHBvc3RNZXRob2QodXJsLCBib2R5LCBoZWFkZXIsIGRhdGFSZWNlaXZlZCkge1xyXG5cclxuICAgIC8vICAgICBsZXQgbW9kYWw6IEh0dHBzUmVxdWVzdE9wdGlvbnMgPSB7XHJcbiAgICAvLyAgICAgICAgIHVybDogdGhpcy5hcGlVUkwgKyB1cmwsXHJcbiAgICAvLyAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgLy8gICAgICAgICBoZWFkZXJzOiBoZWFkZXIsXHJcbiAgICAvLyAgICAgICAgIGJvZHk6IGJvZHlcclxuICAgIC8vICAgICB9O1xyXG5cclxuICAgIC8vICAgICBIdHRwcy5yZXF1ZXN0KG1vZGFsKS5cclxuICAgIC8vICAgICAgICAgdGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgIC8vICAgICAgICAgICAgIGRhdGFSZWNlaXZlZC5uZXh0KHJlc3BvbnNlKTtcclxuICAgIC8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSk7XHJcbiAgICAvLyAgICAgICAgICAgICBkYXRhUmVjZWl2ZWQuY29tcGxldGUoKTtcclxuXHJcbiAgICAvLyAgICAgICAgIH0pLlxyXG4gICAgLy8gICAgICAgICBjYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgIC8vICAgICAgICAgICAgIGRhdGFSZWNlaXZlZC5uZXh0KGVycm9yKTtcclxuICAgIC8vICAgICAgICAgICAgIGRhdGFSZWNlaXZlZC5jb21wbGV0ZSgpO1xyXG4gICAgLy8gICAgICAgICB9KTtcclxuICAgIC8vIH0gXHJcbn0iXX0=