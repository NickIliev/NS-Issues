"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var http_1 = require("@angular/http");
require("rxjs/add/operator/do");
require("rxjs/add/operator/map");
var AesUtil_1 = require("../utils/AesUtil");
var CryptoJS = require('crypto-js');
var GlobalService = (function () {
    function GlobalService(http //, httpInterceptor: HttpInterceptorService
    ) {
        // httpInterceptor.request().addInterceptor((data, method) => {
        //     console.log("encrypt");
        //     console.log(method, data);
        //     return data;
        // });
        this.http = http; //, httpInterceptor: HttpInterceptorService
        // apiURL: string = "http://10.0.2.2:8080/bcbsma/mma/v1/";
        // https://bcbsma-nonprod-dev.apigee.net/verify_stub
        //   apiURL: string = "https://bcbsma-test.apigee.net/";
        this.apiURL = "https://bcbsma-nonprod-dev.apigee.net/";
        // httpInterceptor.response().addInterceptor((res, method) => {
        //     console.log("decrypt");
        //     return res.do(r => console.log(method, r));
        // }); 
    }
    GlobalService.prototype.globalGet = function (url) {
        return this.http.get(this.apiURL + url, this.jwt()).map(function (response) { return response.json(); });
    };
    GlobalService.prototype.bcbsmaGet = function (url, headers) {
        return this.http.get(this.apiURL + url, headers).map(function (response) { return response.json(); });
    };
    GlobalService.prototype.globalPost = function (url, params) {
        return this.http.post(this.apiURL + url, params, this.jwt())
            .map(function (response) { return response.json(); });
    };
    GlobalService.prototype.globalLoginPost = function (url, body) {
        this.encrypt();
        return this.http.post(this.apiURL + url, body, this.loginjwt())
            .map(function (response) { return response.json(); });
    };
    GlobalService.prototype.encrypt = function () {
        var iv = "418f8eddd436d1d96b19b8a85563e7bb"; // "b5ccea620067ce288f603713f39eb00f"; //"6a6c26a8b978f4c006739aae336a7597"; //"F27D5C9927726BCEFE7510B1BDD3D137";
        var salt = "06e02857911c4aa8e2d0c02c6a0ca082aa7e7c13a86545d9b0b2ad55fd61511e"; // "98bb84733547bc5447d2da3aebdb217330476107a175e63ce0bd2407b5d8f57c";// "126583de0858dff5b59ffd3b73f04b45c60d4c95401e6e76accb812139823f42"; //"3FF2EC019C627B945225DEBAD71A01B6985FE84C95A70EB132882F88C0A59A55";
        var keySize = 128;
        var iterationCount = 10000;
        var passphrase = "4f0e2c70dedc3b98284805c141e8d46d708906553f56f7a04b43590d38f2ef8a"; // "81b7a5b797f44c04ad43b63740ffc0d58911b70178cbde9c24e10b8bb06a9e0a"; //"a02e382961c1e0d9010e391af801a6b2018b61562af66ad918db37f60acbbf63"; // "26DEC4ECAF3ABBBCD3C6156704617CCF";
        // var plaintext = "{\"regtypein\":\"EMAIL\",\"useridin\":\"test@test.com\",\"passwordin\":\"password01\",\"receiveinfo\":\"yes\",\"tandcagreed\":\"true‚Äù}";
        //  var plaintext = "{\"regtypein\":\"EMAIL\",\"useridin\":\"test22520@test.com\",\"passwordin\":\"password01\",\"receiveinfo\":\"yes\",\"tandcagreed\":\"true\"}";
        //   var plaintext = "{\"useridin\":\"test22520@test.com\",\"key2id\":\"5023bd2461e9441bb28e7b43793b62e7\"}";
        //  var plaintext = "ysZTaNV0wAYdVE6WcH4zpURITw45K6d86LbFdot9G2rG5b8zaDp8ik8UDSME1zGykltAnv3ZXA1bLc0z+jGh4HmusBmCs30VwuharUXdPD3i6xt6SuG6ox17wKgNPxPlSyMDm+Z6t+9grqPAjFqwEwjQEReC9FcyBYdVYtffkP0Vv9eDtEboqKw84EPaC8jQPbWxRQpmnrGqGCPnZQCpnMnhz2CtqxsrLPelwOzzP6VIgKi/obFzuNb+oLKFmq9DxRp+rgLjTgHXH4Gh1BnC6S97smhO/92Jy4xmdRDuYHyH7BIpXibc6Suq0o1Lu/m9ezwdLOq9mmQuPu3sGYYEIxN1oDFrZ1p/iUS03nF/n/oOjPr8gO4iJe84HJKtBoxu0gVZ20+A9D8O2IXg4ugjDIBgKjqZHIz4KbmIdMnfbjaPSm8bQneXLQm1XRu6VvyDePl27KYmMtbzQwZK3lCA1bmOuCa/E8JUYwDflTEr3VUavEXoD47WHxaFC1s3TXHu";
        // console.log('Plain Text : ' + plaintext);
        var toDecryptText = 'kOWAuf0hKHFW1rlwWc91auvUI2C9+gelPPuSzZlnU1+aosJnVTMC87vUphtvWlRgW4BCz1U3phP5iRELU6Iu0DnuWlClLftGhZ+0bd7KmfrfpGZTwl1hfjcvCgsNOOR8D1y8S19vbxgA6pewE0Ke7/k9Bt2TFjQ2fzfW9xJAoNammSdGmHGrgVHPtBSgmnGZ6KfqWHwGvhJkvzcEn0PcI3paZz94lbd74U04W/aB+ahYkQgvcXQkCKLIrWJjus3JMzzoSM+FuQ9XNbedLKrW4fvpLT4feav3BnRy7bJcswOZwysnnk4DnB4xSa54Y4NkgrnVlteCN2FakAh/Eouj3yx3HvSn/s0pbeKWXIlRsWHNqYE1cUfxK00vaznbMTyp4BK7Rx8DDmPc+nCcG36XwwigLs3Er2yNsOSV6nQ26cpT87haWbpDdUF9f3ECBKAZsA02jdt+Oj8sBJdbb/yneFWNokLbj7DSH4TWNg+fxdvUwUXip3fyLbJVcfmZE7uF6ku11kj8uP+6kXuIVLgkN1e0hVdS0pP9ODyRph2q0X4=';
        var aesUtil = new AesUtil_1.AesUtil(keySize, iterationCount);
        // var ciphertext = aesUtil.encrypt(salt, iv, passphrase, plaintext);
        // console.log('Encrypted Data : ' + ciphertext);
        var decryptedText = aesUtil.decrypt(salt, iv, passphrase, toDecryptText);
        console.log('Decrypted Data : ' + decryptedText);
    };
    // private helper methods
    GlobalService.prototype.jwt = function () {
        // create authorization header with jwt token
        // let currentUser = JSON.parse(localStorage.getItem("currentUser"));
        // if (currentUser && currentUser.token) {
        var headers = new http_1.Headers();
        headers.append("Content-Type", "application/json");
        headers.append("Authorization", "Bearer Fq5xC3LhCUvkcr7qVIJVbmo3LvcO");
        //  headers.append("client_id", "2");
        // headers.append("access_token", "2");
        return new http_1.RequestOptions({ headers: headers });
        // }
    };
    GlobalService.prototype.loginjwt = function () {
        var headers = new http_1.Headers();
        headers.append("Content-Type", "application/json");
        return new http_1.RequestOptions({ headers: headers });
        // return { 'Content-Type': 'application/json' };
    };
    return GlobalService;
}());
GlobalService = __decorate([
    core_1.Injectable(),
    __metadata("design:paramtypes", [http_1.Http //, httpInterceptor: HttpInterceptorService
    ])
], GlobalService);
exports.GlobalService = GlobalService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2xvYmFsLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJnbG9iYWwuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHNDQUEyQztBQUMzQyxzQ0FBd0U7QUFJeEUsZ0NBQThCO0FBQzlCLGlDQUErQjtBQU0vQiw0Q0FBMkM7QUFDM0MsSUFBSSxRQUFRLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFBO0FBR25DLElBQWEsYUFBYTtJQU90Qix1QkFBb0IsSUFBVSxDQUFDLDJDQUEyQzs7UUFJdEUsK0RBQStEO1FBQy9ELDhCQUE4QjtRQUM5QixpQ0FBaUM7UUFDakMsbUJBQW1CO1FBQ25CLE1BQU07UUFSVSxTQUFJLEdBQUosSUFBSSxDQUFNLENBQUMsMkNBQTJDO1FBTjFFLDBEQUEwRDtRQUMxRCxvREFBb0Q7UUFDcEQsd0RBQXdEO1FBQ3hELFdBQU0sR0FBVyx3Q0FBd0MsQ0FBQztRQWF0RCwrREFBK0Q7UUFDL0QsOEJBQThCO1FBQzlCLGtEQUFrRDtRQUNsRCxPQUFPO0lBRVgsQ0FBQztJQUVELGlDQUFTLEdBQVQsVUFBVSxHQUFXO1FBQ2pCLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQyxRQUFrQixJQUFLLE9BQUEsUUFBUSxDQUFDLElBQUksRUFBRSxFQUFmLENBQWUsQ0FBQyxDQUFDO0lBQ3JHLENBQUM7SUFDRCxpQ0FBUyxHQUFULFVBQVUsR0FBVyxFQUFFLE9BQVk7UUFDL0IsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFDLFFBQWtCLElBQUssT0FBQSxRQUFRLENBQUMsSUFBSSxFQUFFLEVBQWYsQ0FBZSxDQUFDLENBQUM7SUFFbEcsQ0FBQztJQUVELGtDQUFVLEdBQVYsVUFBVyxHQUFXLEVBQUUsTUFBVztRQUUvQixNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxHQUFHLEVBQUUsTUFBTSxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQzthQUN4RCxHQUFHLENBQUMsVUFBQyxRQUFrQixJQUFLLE9BQUEsUUFBUSxDQUFDLElBQUksRUFBRSxFQUFmLENBQWUsQ0FBQyxDQUFDO0lBQ3RELENBQUM7SUFFRCx1Q0FBZSxHQUFmLFVBQWdCLEdBQVcsRUFBRSxJQUFTO1FBQ2xDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNmLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBRSxJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO2FBQzVELEdBQUcsQ0FBQyxVQUFDLFFBQWtCLElBQUssT0FBQSxRQUFRLENBQUMsSUFBSSxFQUFFLEVBQWYsQ0FBZSxDQUFDLENBQUM7SUFDckQsQ0FBQztJQUVELCtCQUFPLEdBQVA7UUFDSSxJQUFJLEVBQUUsR0FBRSxrQ0FBa0MsQ0FBQyxDQUFDLGtIQUFrSDtRQUM5SixJQUFJLElBQUksR0FBRSxrRUFBa0UsQ0FBQyxDQUFDLGtOQUFrTjtRQUNoUyxJQUFJLE9BQU8sR0FBRyxHQUFHLENBQUM7UUFDbEIsSUFBSSxjQUFjLEdBQUcsS0FBSyxDQUFDO1FBQzNCLElBQUksVUFBVSxHQUFHLGtFQUFrRSxDQUFDLENBQUMsbUxBQW1MO1FBQzNRLDRKQUE0SjtRQUM3SixtS0FBbUs7UUFDbEssNkdBQTZHO1FBQzlHLHVoQkFBdWhCO1FBQ25oQiw0Q0FBNEM7UUFDNUMsSUFBSSxhQUFhLEdBQUcsOGlCQUE4aUIsQ0FBQztRQUNua0IsSUFBSSxPQUFPLEdBQUcsSUFBSSxpQkFBTyxDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUMsQ0FBQztRQUNuRCxxRUFBcUU7UUFDckUsaURBQWlEO1FBQ2xELElBQUksYUFBYSxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFDLEVBQUUsRUFBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFDdkUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsR0FBRyxhQUFhLENBQUMsQ0FBQztJQUNwRCxDQUFDO0lBR0QseUJBQXlCO0lBQ2xCLDJCQUFHLEdBQVY7UUFDSSw2Q0FBNkM7UUFDN0MscUVBQXFFO1FBQ3JFLDBDQUEwQztRQUMxQyxJQUFJLE9BQU8sR0FBRyxJQUFJLGNBQU8sRUFBRSxDQUFDO1FBQzVCLE9BQU8sQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLGtCQUFrQixDQUFDLENBQUM7UUFDbkQsT0FBTyxDQUFDLE1BQU0sQ0FBQyxlQUFlLEVBQUUscUNBQXFDLENBQUMsQ0FBQztRQUN2RSxxQ0FBcUM7UUFDckMsdUNBQXVDO1FBR3ZDLE1BQU0sQ0FBQyxJQUFJLHFCQUFjLENBQUMsRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztRQUNoRCxJQUFJO0lBQ1IsQ0FBQztJQUNNLGdDQUFRLEdBQWY7UUFDSSxJQUFJLE9BQU8sR0FBRyxJQUFJLGNBQU8sRUFBRSxDQUFDO1FBQzVCLE9BQU8sQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLGtCQUFrQixDQUFDLENBQUM7UUFDbkQsTUFBTSxDQUFDLElBQUkscUJBQWMsQ0FBQyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQ2hELGlEQUFpRDtJQUNyRCxDQUFDO0lBdUJMLG9CQUFDO0FBQUQsQ0FBQyxBQTNHRCxJQTJHQztBQTNHWSxhQUFhO0lBRHpCLGlCQUFVLEVBQUU7cUNBUWlCLFdBQUksQ0FBQywyQ0FBMkM7O0dBUGpFLGFBQWEsQ0EyR3pCO0FBM0dZLHNDQUFhIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBIdHRwLCBIZWFkZXJzLCBSZXF1ZXN0T3B0aW9ucywgUmVzcG9uc2UgfSBmcm9tIFwiQGFuZ3VsYXIvaHR0cFwiO1xuLy9pbXBvcnQgeyBIdHRwSW50ZXJjZXB0b3JTZXJ2aWNlIH0gZnJvbSBcIm5nLWh0dHAtaW50ZXJjZXB0b3JcIjtcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwicnhqcy9PYnNlcnZhYmxlXCI7XG5cbmltcG9ydCBcInJ4anMvYWRkL29wZXJhdG9yL2RvXCI7XG5pbXBvcnQgXCJyeGpzL2FkZC9vcGVyYXRvci9tYXBcIjtcblxuLy9pbXBvcnQgKiBhcyBIdHRwcyBmcm9tICduYXRpdmVzY3JpcHQtaHR0cHMnO1xuLy9pbXBvcnQgeyBIdHRwc1JlcXVlc3RPcHRpb25zIH0gZnJvbSAnbmF0aXZlc2NyaXB0LWh0dHBzJztcblxuaW1wb3J0IHsgQXN5bmNTdWJqZWN0IH0gZnJvbSAncnhqcy9Bc3luY1N1YmplY3QnO1xuaW1wb3J0IHsgQWVzVXRpbCB9IGZyb20gJy4uL3V0aWxzL0Flc1V0aWwnO1xudmFyIENyeXB0b0pTID0gcmVxdWlyZSgnY3J5cHRvLWpzJylcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIEdsb2JhbFNlcnZpY2Uge1xuICAgIC8vIGFwaVVSTDogc3RyaW5nID0gXCJodHRwOi8vMTAuMC4yLjI6ODA4MC9iY2JzbWEvbW1hL3YxL1wiO1xuICAgIC8vIGh0dHBzOi8vYmNic21hLW5vbnByb2QtZGV2LmFwaWdlZS5uZXQvdmVyaWZ5X3N0dWJcbiAgICAvLyAgIGFwaVVSTDogc3RyaW5nID0gXCJodHRwczovL2JjYnNtYS10ZXN0LmFwaWdlZS5uZXQvXCI7XG4gICAgYXBpVVJMOiBzdHJpbmcgPSBcImh0dHBzOi8vYmNic21hLW5vbnByb2QtZGV2LmFwaWdlZS5uZXQvXCI7XG5cblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgaHR0cDogSHR0cCAvLywgaHR0cEludGVyY2VwdG9yOiBIdHRwSW50ZXJjZXB0b3JTZXJ2aWNlXG4gICAgKSB7XG5cblxuICAgICAgICAvLyBodHRwSW50ZXJjZXB0b3IucmVxdWVzdCgpLmFkZEludGVyY2VwdG9yKChkYXRhLCBtZXRob2QpID0+IHtcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKFwiZW5jcnlwdFwiKTtcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKG1ldGhvZCwgZGF0YSk7XG4gICAgICAgIC8vICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgLy8gaHR0cEludGVyY2VwdG9yLnJlc3BvbnNlKCkuYWRkSW50ZXJjZXB0b3IoKHJlcywgbWV0aG9kKSA9PiB7XG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhcImRlY3J5cHRcIik7XG4gICAgICAgIC8vICAgICByZXR1cm4gcmVzLmRvKHIgPT4gY29uc29sZS5sb2cobWV0aG9kLCByKSk7XG4gICAgICAgIC8vIH0pOyBcblxuICAgIH1cblxuICAgIGdsb2JhbEdldCh1cmw6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gdGhpcy5odHRwLmdldCh0aGlzLmFwaVVSTCArIHVybCwgdGhpcy5qd3QoKSkubWFwKChyZXNwb25zZTogUmVzcG9uc2UpID0+IHJlc3BvbnNlLmpzb24oKSk7XG4gICAgfVxuICAgIGJjYnNtYUdldCh1cmw6IHN0cmluZywgaGVhZGVyczogYW55KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHRoaXMuYXBpVVJMICsgdXJsLCBoZWFkZXJzKS5tYXAoKHJlc3BvbnNlOiBSZXNwb25zZSkgPT4gcmVzcG9uc2UuanNvbigpKTtcblxuICAgIH1cblxuICAgIGdsb2JhbFBvc3QodXJsOiBzdHJpbmcsIHBhcmFtczogYW55KSB7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KMKgdGhpcy5hcGlVUkwgKyB1cmwsIHBhcmFtcywgdGhpcy5qd3QoKSlcbiAgICAgICAgICAgIC5tYXAoKHJlc3BvbnNlOiBSZXNwb25zZSkgPT4gcmVzcG9uc2UuanNvbigpKTtcbiAgICB9XG4gICAgICAgXG4gICAgZ2xvYmFsTG9naW5Qb3N0KHVybDogc3RyaW5nLCBib2R5OiBhbnkpIHtcbiAgICAgICAgdGhpcy5lbmNyeXB0KCk7XG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCjCoHRoaXMuYXBpVVJMICsgdXJsLCBib2R5LCB0aGlzLmxvZ2luand0KCkpXG4gICAgICAgICAgIC5tYXAoKHJlc3BvbnNlOiBSZXNwb25zZSkgPT4gcmVzcG9uc2UuanNvbigpKTtcbiAgICB9XG5cbiAgICBlbmNyeXB0KCl7XG4gICAgICAgIHZhciBpdiA9XCI0MThmOGVkZGQ0MzZkMWQ5NmIxOWI4YTg1NTYzZTdiYlwiOyAvLyBcImI1Y2NlYTYyMDA2N2NlMjg4ZjYwMzcxM2YzOWViMDBmXCI7IC8vXCI2YTZjMjZhOGI5NzhmNGMwMDY3MzlhYWUzMzZhNzU5N1wiOyAvL1wiRjI3RDVDOTkyNzcyNkJDRUZFNzUxMEIxQkREM0QxMzdcIjtcbiAgICAgICAgdmFyIHNhbHQgPVwiMDZlMDI4NTc5MTFjNGFhOGUyZDBjMDJjNmEwY2EwODJhYTdlN2MxM2E4NjU0NWQ5YjBiMmFkNTVmZDYxNTExZVwiOyAvLyBcIjk4YmI4NDczMzU0N2JjNTQ0N2QyZGEzYWViZGIyMTczMzA0NzYxMDdhMTc1ZTYzY2UwYmQyNDA3YjVkOGY1N2NcIjsvLyBcIjEyNjU4M2RlMDg1OGRmZjViNTlmZmQzYjczZjA0YjQ1YzYwZDRjOTU0MDFlNmU3NmFjY2I4MTIxMzk4MjNmNDJcIjsgLy9cIjNGRjJFQzAxOUM2MjdCOTQ1MjI1REVCQUQ3MUEwMUI2OTg1RkU4NEM5NUE3MEVCMTMyODgyRjg4QzBBNTlBNTVcIjtcbiAgICAgICAgdmFyIGtleVNpemUgPSAxMjg7XG4gICAgICAgIHZhciBpdGVyYXRpb25Db3VudCA9IDEwMDAwO1xuICAgICAgICB2YXIgcGFzc3BocmFzZSA9IFwiNGYwZTJjNzBkZWRjM2I5ODI4NDgwNWMxNDFlOGQ0NmQ3MDg5MDY1NTNmNTZmN2EwNGI0MzU5MGQzOGYyZWY4YVwiOyAvLyBcIjgxYjdhNWI3OTdmNDRjMDRhZDQzYjYzNzQwZmZjMGQ1ODkxMWI3MDE3OGNiZGU5YzI0ZTEwYjhiYjA2YTllMGFcIjsgLy9cImEwMmUzODI5NjFjMWUwZDkwMTBlMzkxYWY4MDFhNmIyMDE4YjYxNTYyYWY2NmFkOTE4ZGIzN2Y2MGFjYmJmNjNcIjsgLy8gXCIyNkRFQzRFQ0FGM0FCQkJDRDNDNjE1NjcwNDYxN0NDRlwiO1xuICAgICAvLyB2YXIgcGxhaW50ZXh0ID0gXCJ7XFxcInJlZ3R5cGVpblxcXCI6XFxcIkVNQUlMXFxcIixcXFwidXNlcmlkaW5cXFwiOlxcXCJ0ZXN0QHRlc3QuY29tXFxcIixcXFwicGFzc3dvcmRpblxcXCI6XFxcInBhc3N3b3JkMDFcXFwiLFxcXCJyZWNlaXZlaW5mb1xcXCI6XFxcInllc1xcXCIsXFxcInRhbmRjYWdyZWVkXFxcIjpcXFwidHJ1ZeKAnX1cIjtcbiAgICAvLyAgdmFyIHBsYWludGV4dCA9IFwie1xcXCJyZWd0eXBlaW5cXFwiOlxcXCJFTUFJTFxcXCIsXFxcInVzZXJpZGluXFxcIjpcXFwidGVzdDIyNTIwQHRlc3QuY29tXFxcIixcXFwicGFzc3dvcmRpblxcXCI6XFxcInBhc3N3b3JkMDFcXFwiLFxcXCJyZWNlaXZlaW5mb1xcXCI6XFxcInllc1xcXCIsXFxcInRhbmRjYWdyZWVkXFxcIjpcXFwidHJ1ZVxcXCJ9XCI7XG4gICAgIC8vICAgdmFyIHBsYWludGV4dCA9IFwie1xcXCJ1c2VyaWRpblxcXCI6XFxcInRlc3QyMjUyMEB0ZXN0LmNvbVxcXCIsXFxcImtleTJpZFxcXCI6XFxcIjUwMjNiZDI0NjFlOTQ0MWJiMjhlN2I0Mzc5M2I2MmU3XFxcIn1cIjtcbiAgICAvLyAgdmFyIHBsYWludGV4dCA9IFwieXNaVGFOVjB3QVlkVkU2V2NINHpwVVJJVHc0NUs2ZDg2TGJGZG90OUcyckc1Yjh6YURwOGlrOFVEU01FMXpHeWtsdEFudjNaWEExYkxjMHorakdoNEhtdXNCbUNzMzBWd3VoYXJVWGRQRDNpNnh0NlN1RzZveDE3d0tnTlB4UGxTeU1EbStaNnQrOWdycVBBakZxd0V3alFFUmVDOUZjeUJZZFZZdGZma1AwVnY5ZUR0RWJvcUt3ODRFUGFDOGpRUGJXeFJRcG1uckdxR0NQblpRQ3BuTW5oejJDdHF4c3JMUGVsd096elA2VklnS2kvb2JGenVOYitvTEtGbXE5RHhScCtyZ0xqVGdIWEg0R2gxQm5DNlM5N3NtaE8vOTJKeTR4bWRSRHVZSHlIN0JJcFhpYmM2U3VxMG8xTHUvbTllendkTE9xOW1tUXVQdTNzR1lZRUl4TjFvREZyWjFwL2lVUzAzbkYvbi9vT2pQcjhnTzRpSmU4NEhKS3RCb3h1MGdWWjIwK0E5RDhPMklYZzR1Z2pESUJnS2pxWkhJejRLYm1JZE1uZmJqYVBTbThiUW5lWExRbTFYUnU2VnZ5RGVQbDI3S1ltTXRielF3WkszbENBMWJtT3VDYS9FOEpVWXdEZmxURXIzVlVhdkVYb0Q0N1dIeGFGQzFzM1RYSHVcIjtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ1BsYWluIFRleHQgOiAnICsgcGxhaW50ZXh0KTtcbiAgICAgICAgdmFyIHRvRGVjcnlwdFRleHQgPSAna09XQXVmMGhLSEZXMXJsd1djOTFhdXZVSTJDOStnZWxQUHVTelpsblUxK2Fvc0puVlRNQzg3dlVwaHR2V2xSZ1c0QkN6MVUzcGhQNWlSRUxVNkl1MERudVdsQ2xMZnRHaForMGJkN0ttZnJmcEdaVHdsMWhmamN2Q2dzTk9PUjhEMXk4UzE5dmJ4Z0E2cGV3RTBLZTcvazlCdDJURmpRMmZ6Zlc5eEpBb05hbW1TZEdtSEdyZ1ZIUHRCU2dtbkdaNktmcVdId0d2aEprdnpjRW4wUGNJM3BhWno5NGxiZDc0VTA0Vy9hQithaFlrUWd2Y1hRa0NLTElyV0pqdXMzSk16em9TTStGdVE5WE5iZWRMS3JXNGZ2cExUNGZlYXYzQm5SeTdiSmNzd09ad3lzbm5rNERuQjR4U2E1NFk0Tmtncm5WbHRlQ04yRmFrQWgvRW91ajN5eDNIdlNuL3MwcGJlS1dYSWxSc1dITnFZRTFjVWZ4SzAwdmF6bmJNVHlwNEJLN1J4OEREbVBjK25DY0czNlh3d2lnTHMzRXIyeU5zT1NWNm5RMjZjcFQ4N2hhV2JwRGRVRjlmM0VDQktBWnNBMDJqZHQrT2o4c0JKZGJiL3luZUZXTm9rTGJqN0RTSDRUV05nK2Z4ZHZVd1VYaXAzZnlMYkpWY2ZtWkU3dUY2a3UxMWtqOHVQKzZrWHVJVkxna04xZTBoVmRTMHBQOU9EeVJwaDJxMFg0PSc7XG4gICAgICAgIHZhciBhZXNVdGlsID0gbmV3IEFlc1V0aWwoa2V5U2l6ZSwgaXRlcmF0aW9uQ291bnQpO1xuICAgICAgICAvLyB2YXIgY2lwaGVydGV4dCA9IGFlc1V0aWwuZW5jcnlwdChzYWx0LCBpdiwgcGFzc3BocmFzZSwgcGxhaW50ZXh0KTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ0VuY3J5cHRlZCBEYXRhIDogJyArIGNpcGhlcnRleHQpO1xuICAgICAgIHZhciBkZWNyeXB0ZWRUZXh0ID0gYWVzVXRpbC5kZWNyeXB0KHNhbHQsaXYscGFzc3BocmFzZSwgdG9EZWNyeXB0VGV4dCk7XG4gICAgICAgY29uc29sZS5sb2coJ0RlY3J5cHRlZCBEYXRhIDogJyArIGRlY3J5cHRlZFRleHQpO1xuICAgIH1cblxuXG4gICAgLy8gcHJpdmF0ZSBoZWxwZXIgbWV0aG9kc1xuICAgIHB1YmxpYyBqd3QoKSB7XG4gICAgICAgIC8vIGNyZWF0ZSBhdXRob3JpemF0aW9uIGhlYWRlciB3aXRoIGp3dCB0b2tlblxuICAgICAgICAvLyBsZXQgY3VycmVudFVzZXIgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudFVzZXJcIikpO1xuICAgICAgICAvLyBpZiAoY3VycmVudFVzZXIgJiYgY3VycmVudFVzZXIudG9rZW4pIHtcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQXV0aG9yaXphdGlvblwiLCBcIkJlYXJlciBGcTV4QzNMaENVdmtjcjdxVklKVmJtbzNMdmNPXCIpO1xuICAgICAgICAvLyAgaGVhZGVycy5hcHBlbmQoXCJjbGllbnRfaWRcIiwgXCIyXCIpO1xuICAgICAgICAvLyBoZWFkZXJzLmFwcGVuZChcImFjY2Vzc190b2tlblwiLCBcIjJcIik7XG5cblxuICAgICAgICByZXR1cm4gbmV3IFJlcXVlc3RPcHRpb25zKHsgaGVhZGVyczogaGVhZGVycyB9KTtcbiAgICAgICAgLy8gfVxuICAgIH1cbiAgICBwdWJsaWMgbG9naW5qd3QoKSB7XG4gICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJDb250ZW50LVR5cGVcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xuICAgICAgICByZXR1cm4gbmV3IFJlcXVlc3RPcHRpb25zKHsgaGVhZGVyczogaGVhZGVycyB9KTsgXG4gICAgICAgIC8vIHJldHVybiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfTtcbiAgICB9XG5cbiAgICAvLyAgcHVibGljIHBvc3RNZXRob2QodXJsLCBib2R5LCBoZWFkZXIsIGRhdGFSZWNlaXZlZCkge1xuXG4gICAgLy8gICAgIGxldCBtb2RhbDogSHR0cHNSZXF1ZXN0T3B0aW9ucyA9IHtcbiAgICAvLyAgICAgICAgIHVybDogdGhpcy5hcGlVUkwgKyB1cmwsXG4gICAgLy8gICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAvLyAgICAgICAgIGhlYWRlcnM6IGhlYWRlcixcbiAgICAvLyAgICAgICAgIGJvZHk6IGJvZHlcbiAgICAvLyAgICAgfTtcblxuICAgIC8vICAgICBIdHRwcy5yZXF1ZXN0KG1vZGFsKS5cbiAgICAvLyAgICAgICAgIHRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgLy8gICAgICAgICAgICAgZGF0YVJlY2VpdmVkLm5leHQocmVzcG9uc2UpO1xuICAgIC8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSk7XG4gICAgLy8gICAgICAgICAgICAgZGF0YVJlY2VpdmVkLmNvbXBsZXRlKCk7XG5cbiAgICAvLyAgICAgICAgIH0pLlxuICAgIC8vICAgICAgICAgY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgLy8gICAgICAgICAgICAgZGF0YVJlY2VpdmVkLm5leHQoZXJyb3IpO1xuICAgIC8vICAgICAgICAgICAgIGRhdGFSZWNlaXZlZC5jb21wbGV0ZSgpO1xuICAgIC8vICAgICAgICAgfSk7XG4gICAgLy8gfSBcbn0iXX0=